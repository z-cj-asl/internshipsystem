{"ast":null,"code":"var mysql = require('mysql');\n\nconst connectDB = mysql.createConnection({\n  host: 'localhost',\n  user: 'root',\n  password: '9364',\n  database: 'internshipDB'\n});\n\nfunction login(username1, password1) {\n  connectDB.connect(err => {\n    if (err) throw err;\n    console.log('mysql test connected ');\n  });\n  const username = username1;\n  const password = password1;\n  let sql = 'select * from user where user.username = \"' + username + '\"'; //let sql = 'select * from user'\n\n  const result = connectDB.query(sql, (err, result) => {\n    if (err) {\n      console.log(err);\n      return;\n    } //console.log(result)\n\n  });\n\n  if (result) {\n    if (result.password === password) {\n      return {\n        state: 4000,\n        msg: '登录成功'\n      };\n    } else {\n      return {\n        state: 3000,\n        msg: '密码错误'\n      };\n    }\n  } else {\n    return {\n      state: 3000,\n      msg: '账号不存在，请注册'\n    };\n  }\n}\n\nfunction sign() {\n  connectDB.connect(err => {\n    if (err) throw err;\n    console.log('mysql test connected ');\n  });\n  const username = \"root2\";\n  const password = \"123456\";\n  let sql1 = 'select * from user where user.username = \"' + username + '\"';\n  const result1 = connectDB.query(sql1, (err, result) => {\n    if (err) {\n      console.log(err);\n      return;\n    }\n  }); //console.log('@result1',result1)\n\n  if (!(result1.username === username)) {\n    let sql = 'insert into user (username , password) value (\"' + username + '\",\"' + password + '\")';\n    const result = connectDB.query(sql, (err, result) => {\n      if (err) {\n        console.log(err);\n        return;\n      } //console.log(result)\n\n    });\n\n    if (result) {\n      console.log({\n        state: 4000,\n        msg: '注册成功'\n      });\n      return {\n        state: 4000,\n        msg: '注册成功'\n      };\n    } else {\n      return {\n        state: 3000,\n        msg: '注册失败'\n      };\n    }\n  } else {\n    return {\n      state: 3000,\n      msg: '账号已存在，请更换账号'\n    };\n  }\n} //login ();\n\n\nsign();\nmodule.exports = [['GET', 'api/login', login], ['POST', 'api/sign', sign]];","map":{"version":3,"names":["mysql","require","connectDB","createConnection","host","user","password","database","login","username1","password1","connect","err","console","log","username","sql","result","query","state","msg","sign","sql1","result1","module","exports"],"sources":["C:/Users/ZCJ/Desktop/internshipsysrem/src/server/api/user.js"],"sourcesContent":["var mysql = require('mysql')\r\n\r\nconst connectDB = mysql.createConnection({\r\n    host: 'localhost',\r\n    user: 'root',\r\n    password: '9364',\r\n    database: 'internshipDB'\r\n})\r\n\r\nfunction login (username1 ,password1) {\r\n    connectDB.connect(err => { \r\n        if (err) \r\n        throw err; console.log('mysql test connected ')    \r\n    });\r\n\r\n    const username = username1;\r\n    const password = password1;\r\n    let sql = 'select * from user where user.username = \"' + username + '\"' \r\n    //let sql = 'select * from user'\r\n\r\n    const result = connectDB.query(sql, (err, result) => {\r\n        if(err){\r\n            console.log(err);\r\n            return\r\n        }\r\n        //console.log(result)\r\n    })\r\n\r\n    if(result){\r\n        if(result.password === password){\r\n            return({\r\n                state: 4000,\r\n                msg: '登录成功'\r\n            })\r\n        }\r\n        else{\r\n            return({\r\n                state: 3000,\r\n                msg: '密码错误'\r\n            })\r\n        }    \r\n    }\r\n    else{\r\n        return({\r\n            state: 3000,\r\n            msg: '账号不存在，请注册'\r\n        })\r\n    }\r\n}\r\n\r\nfunction sign () {\r\n    connectDB.connect(err => { \r\n        if (err) \r\n        throw err; console.log('mysql test connected ')    \r\n    });\r\n\r\n    const username = \"root2\";\r\n    const password = \"123456\";\r\n\r\n    let sql1 = 'select * from user where user.username = \"' + username + '\"' \r\n    const result1 = connectDB.query(sql1, (err, result) => {\r\n        if(err){\r\n            console.log(err);\r\n            return\r\n        }\r\n    })\r\n    //console.log('@result1',result1)\r\n\r\n    if(!(result1.username === username)){\r\n        let sql = 'insert into user (username , password) value (\"' + username + '\",\"'+ password + '\")'\r\n        const result = connectDB.query(sql, (err, result) => {\r\n            if(err){\r\n                console.log(err);\r\n                return\r\n            }\r\n            //console.log(result)\r\n        })\r\n\r\n        if(result){\r\n            console.log({\r\n                state: 4000,\r\n                msg: '注册成功'\r\n            });\r\n            return({\r\n                state: 4000,\r\n                msg: '注册成功'\r\n            })\r\n        }\r\n        else{\r\n            return({\r\n                state: 3000,\r\n                msg: '注册失败'\r\n            })\r\n        }    \r\n    }\r\n    else{\r\n        return({\r\n            state: 3000,\r\n            msg: '账号已存在，请更换账号'\r\n        })\r\n        \r\n    }\r\n}\r\n\r\n\r\n//login ();\r\nsign();\r\n\r\nmodule.exports = [\r\n    ['GET', 'api/login', login],\r\n    ['POST', 'api/sign', sign],\r\n]\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}