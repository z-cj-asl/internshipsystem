{"ast":null,"code":"var Crypto = require('crypto');\n\nvar Events = require('events');\n\nvar Net = require('net');\n\nvar tls = require('tls');\n\nvar ConnectionConfig = require('./ConnectionConfig');\n\nvar Protocol = require('./protocol/Protocol');\n\nvar SqlString = require('./protocol/SqlString');\n\nvar Query = require('./protocol/sequences/Query');\n\nvar Util = require('util');\n\nmodule.exports = Connection;\nUtil.inherits(Connection, Events.EventEmitter);\n\nfunction Connection(options) {\n  Events.EventEmitter.call(this);\n  this.config = options.config;\n  this._socket = options.socket;\n  this._protocol = new Protocol({\n    config: this.config,\n    connection: this\n  });\n  this._connectCalled = false;\n  this.state = 'disconnected';\n  this.threadId = null;\n}\n\nConnection.createQuery = function createQuery(sql, values, callback) {\n  if (sql instanceof Query) {\n    return sql;\n  }\n\n  var cb = callback;\n  var options = {};\n\n  if (typeof sql === 'function') {\n    cb = sql;\n  } else if (typeof sql === 'object') {\n    options = Object.create(sql);\n\n    if (typeof values === 'function') {\n      cb = values;\n    } else if (values !== undefined) {\n      Object.defineProperty(options, 'values', {\n        value: values\n      });\n    }\n  } else {\n    options.sql = sql;\n\n    if (typeof values === 'function') {\n      cb = values;\n    } else if (values !== undefined) {\n      options.values = values;\n    }\n  }\n\n  if (cb !== undefined) {\n    cb = wrapCallbackInDomain(null, cb);\n\n    if (cb === undefined) {\n      throw new TypeError('argument callback must be a function when provided');\n    }\n  }\n\n  return new Query(options, cb);\n};\n\nConnection.prototype.connect = function connect(options, callback) {\n  if (!callback && typeof options === 'function') {\n    callback = options;\n    options = {};\n  }\n\n  if (!this._connectCalled) {\n    this._connectCalled = true; // Connect either via a UNIX domain socket or a TCP socket.\n\n    this._socket = this.config.socketPath ? Net.createConnection(this.config.socketPath) : Net.createConnection(this.config.port, this.config.host); // Connect socket to connection domain\n\n    if (Events.usingDomains) {\n      this._socket.domain = this.domain;\n    }\n\n    var connection = this;\n\n    this._protocol.on('data', function (data) {\n      connection._socket.write(data);\n    });\n\n    this._socket.on('data', wrapToDomain(connection, function (data) {\n      connection._protocol.write(data);\n    }));\n\n    this._protocol.on('end', function () {\n      connection._socket.end();\n    });\n\n    this._socket.on('end', wrapToDomain(connection, function () {\n      connection._protocol.end();\n    }));\n\n    this._socket.on('error', this._handleNetworkError.bind(this));\n\n    this._socket.on('connect', this._handleProtocolConnect.bind(this));\n\n    this._protocol.on('handshake', this._handleProtocolHandshake.bind(this));\n\n    this._protocol.on('initialize', this._handleProtocolInitialize.bind(this));\n\n    this._protocol.on('unhandledError', this._handleProtocolError.bind(this));\n\n    this._protocol.on('drain', this._handleProtocolDrain.bind(this));\n\n    this._protocol.on('end', this._handleProtocolEnd.bind(this));\n\n    this._protocol.on('enqueue', this._handleProtocolEnqueue.bind(this));\n\n    if (this.config.connectTimeout) {\n      var handleConnectTimeout = this._handleConnectTimeout.bind(this);\n\n      this._socket.setTimeout(this.config.connectTimeout, handleConnectTimeout);\n\n      this._socket.once('connect', function () {\n        this.setTimeout(0, handleConnectTimeout);\n      });\n    }\n  }\n\n  this._protocol.handshake(options, wrapCallbackInDomain(this, callback));\n};\n\nConnection.prototype.changeUser = function changeUser(options, callback) {\n  if (!callback && typeof options === 'function') {\n    callback = options;\n    options = {};\n  }\n\n  this._implyConnect();\n\n  var charsetNumber = options.charset ? ConnectionConfig.getCharsetNumber(options.charset) : this.config.charsetNumber;\n  return this._protocol.changeUser({\n    user: options.user || this.config.user,\n    password: options.password || this.config.password,\n    database: options.database || this.config.database,\n    timeout: options.timeout,\n    charsetNumber: charsetNumber,\n    currentConfig: this.config\n  }, wrapCallbackInDomain(this, callback));\n};\n\nConnection.prototype.beginTransaction = function beginTransaction(options, callback) {\n  if (!callback && typeof options === 'function') {\n    callback = options;\n    options = {};\n  }\n\n  options = options || {};\n  options.sql = 'START TRANSACTION';\n  options.values = null;\n  return this.query(options, callback);\n};\n\nConnection.prototype.commit = function commit(options, callback) {\n  if (!callback && typeof options === 'function') {\n    callback = options;\n    options = {};\n  }\n\n  options = options || {};\n  options.sql = 'COMMIT';\n  options.values = null;\n  return this.query(options, callback);\n};\n\nConnection.prototype.rollback = function rollback(options, callback) {\n  if (!callback && typeof options === 'function') {\n    callback = options;\n    options = {};\n  }\n\n  options = options || {};\n  options.sql = 'ROLLBACK';\n  options.values = null;\n  return this.query(options, callback);\n};\n\nConnection.prototype.query = function query(sql, values, cb) {\n  var query = Connection.createQuery(sql, values, cb);\n  query._connection = this;\n\n  if (!(typeof sql === 'object' && 'typeCast' in sql)) {\n    query.typeCast = this.config.typeCast;\n  }\n\n  if (query.sql) {\n    query.sql = this.format(query.sql, query.values);\n  }\n\n  if (query._callback) {\n    query._callback = wrapCallbackInDomain(this, query._callback);\n  }\n\n  this._implyConnect();\n\n  return this._protocol._enqueue(query);\n};\n\nConnection.prototype.ping = function ping(options, callback) {\n  if (!callback && typeof options === 'function') {\n    callback = options;\n    options = {};\n  }\n\n  this._implyConnect();\n\n  this._protocol.ping(options, wrapCallbackInDomain(this, callback));\n};\n\nConnection.prototype.statistics = function statistics(options, callback) {\n  if (!callback && typeof options === 'function') {\n    callback = options;\n    options = {};\n  }\n\n  this._implyConnect();\n\n  this._protocol.stats(options, wrapCallbackInDomain(this, callback));\n};\n\nConnection.prototype.end = function end(options, callback) {\n  var cb = callback;\n  var opts = options;\n\n  if (!callback && typeof options === 'function') {\n    cb = options;\n    opts = null;\n  } // create custom options reference\n\n\n  opts = Object.create(opts || null);\n\n  if (opts.timeout === undefined) {\n    // default timeout of 30 seconds\n    opts.timeout = 30000;\n  }\n\n  this._implyConnect();\n\n  this._protocol.quit(opts, wrapCallbackInDomain(this, cb));\n};\n\nConnection.prototype.destroy = function () {\n  this.state = 'disconnected';\n\n  this._implyConnect();\n\n  this._socket.destroy();\n\n  this._protocol.destroy();\n};\n\nConnection.prototype.pause = function () {\n  this._socket.pause();\n\n  this._protocol.pause();\n};\n\nConnection.prototype.resume = function () {\n  this._socket.resume();\n\n  this._protocol.resume();\n};\n\nConnection.prototype.escape = function (value) {\n  return SqlString.escape(value, false, this.config.timezone);\n};\n\nConnection.prototype.escapeId = function escapeId(value) {\n  return SqlString.escapeId(value, false);\n};\n\nConnection.prototype.format = function (sql, values) {\n  if (typeof this.config.queryFormat === 'function') {\n    return this.config.queryFormat.call(this, sql, values, this.config.timezone);\n  }\n\n  return SqlString.format(sql, values, this.config.stringifyObjects, this.config.timezone);\n};\n\nif (tls.TLSSocket) {\n  // 0.11+ environment\n  Connection.prototype._startTLS = function _startTLS(onSecure) {\n    var connection = this;\n    createSecureContext(this.config, function (err, secureContext) {\n      if (err) {\n        onSecure(err);\n        return;\n      } // \"unpipe\"\n\n\n      connection._socket.removeAllListeners('data');\n\n      connection._protocol.removeAllListeners('data'); // socket <-> encrypted\n\n\n      var rejectUnauthorized = connection.config.ssl.rejectUnauthorized;\n      var secureEstablished = false;\n      var secureSocket = new tls.TLSSocket(connection._socket, {\n        rejectUnauthorized: rejectUnauthorized,\n        requestCert: true,\n        secureContext: secureContext,\n        isServer: false\n      }); // error handler for secure socket\n\n      secureSocket.on('_tlsError', function (err) {\n        if (secureEstablished) {\n          connection._handleNetworkError(err);\n        } else {\n          onSecure(err);\n        }\n      }); // cleartext <-> protocol\n\n      secureSocket.pipe(connection._protocol);\n\n      connection._protocol.on('data', function (data) {\n        secureSocket.write(data);\n      });\n\n      secureSocket.on('secure', function () {\n        secureEstablished = true;\n        onSecure(rejectUnauthorized ? this.ssl.verifyError() : null);\n      }); // start TLS communications\n\n      secureSocket._start();\n    });\n  };\n} else {\n  // pre-0.11 environment\n  Connection.prototype._startTLS = function _startTLS(onSecure) {\n    // before TLS:\n    //  _socket <-> _protocol\n    // after:\n    //  _socket <-> securePair.encrypted <-> securePair.cleartext <-> _protocol\n    var connection = this;\n    var credentials = Crypto.createCredentials({\n      ca: this.config.ssl.ca,\n      cert: this.config.ssl.cert,\n      ciphers: this.config.ssl.ciphers,\n      key: this.config.ssl.key,\n      passphrase: this.config.ssl.passphrase\n    });\n    var rejectUnauthorized = this.config.ssl.rejectUnauthorized;\n    var secureEstablished = false;\n    var securePair = tls.createSecurePair(credentials, false, true, rejectUnauthorized); // error handler for secure pair\n\n    securePair.on('error', function (err) {\n      if (secureEstablished) {\n        connection._handleNetworkError(err);\n      } else {\n        onSecure(err);\n      }\n    }); // \"unpipe\"\n\n    this._socket.removeAllListeners('data');\n\n    this._protocol.removeAllListeners('data'); // socket <-> encrypted\n\n\n    securePair.encrypted.pipe(this._socket);\n\n    this._socket.on('data', function (data) {\n      securePair.encrypted.write(data);\n    }); // cleartext <-> protocol\n\n\n    securePair.cleartext.pipe(this._protocol);\n\n    this._protocol.on('data', function (data) {\n      securePair.cleartext.write(data);\n    }); // secure established\n\n\n    securePair.on('secure', function () {\n      secureEstablished = true;\n\n      if (!rejectUnauthorized) {\n        onSecure();\n        return;\n      }\n\n      var verifyError = this.ssl.verifyError();\n      var err = verifyError; // node.js 0.6 support\n\n      if (typeof err === 'string') {\n        err = new Error(verifyError);\n        err.code = verifyError;\n      }\n\n      onSecure(err);\n    }); // node.js 0.8 bug\n\n    securePair._cycle = securePair.cycle;\n\n    securePair.cycle = function cycle() {\n      if (this.ssl && this.ssl.error) {\n        this.error();\n      }\n\n      return this._cycle.apply(this, arguments);\n    };\n  };\n}\n\nConnection.prototype._handleConnectTimeout = function () {\n  if (this._socket) {\n    this._socket.setTimeout(0);\n\n    this._socket.destroy();\n  }\n\n  var err = new Error('connect ETIMEDOUT');\n  err.errorno = 'ETIMEDOUT';\n  err.code = 'ETIMEDOUT';\n  err.syscall = 'connect';\n\n  this._handleNetworkError(err);\n};\n\nConnection.prototype._handleNetworkError = function (err) {\n  this._protocol.handleNetworkError(err);\n};\n\nConnection.prototype._handleProtocolError = function (err) {\n  this.state = 'protocol_error';\n  this.emit('error', err);\n};\n\nConnection.prototype._handleProtocolDrain = function () {\n  this.emit('drain');\n};\n\nConnection.prototype._handleProtocolConnect = function () {\n  this.state = 'connected';\n  this.emit('connect');\n};\n\nConnection.prototype._handleProtocolHandshake = function _handleProtocolHandshake() {\n  this.state = 'authenticated';\n};\n\nConnection.prototype._handleProtocolInitialize = function _handleProtocolInitialize(packet) {\n  this.threadId = packet.threadId;\n};\n\nConnection.prototype._handleProtocolEnd = function (err) {\n  this.state = 'disconnected';\n  this.emit('end', err);\n};\n\nConnection.prototype._handleProtocolEnqueue = function _handleProtocolEnqueue(sequence) {\n  this.emit('enqueue', sequence);\n};\n\nConnection.prototype._implyConnect = function () {\n  if (!this._connectCalled) {\n    this.connect();\n  }\n};\n\nfunction createSecureContext(config, cb) {\n  var context = null;\n  var error = null;\n\n  try {\n    context = tls.createSecureContext({\n      ca: config.ssl.ca,\n      cert: config.ssl.cert,\n      ciphers: config.ssl.ciphers,\n      key: config.ssl.key,\n      passphrase: config.ssl.passphrase\n    });\n  } catch (err) {\n    error = err;\n  }\n\n  cb(error, context);\n}\n\nfunction unwrapFromDomain(fn) {\n  return function () {\n    var domains = [];\n    var ret;\n\n    while (process.domain) {\n      domains.shift(process.domain);\n      process.domain.exit();\n    }\n\n    try {\n      ret = fn.apply(this, arguments);\n    } finally {\n      for (var i = 0; i < domains.length; i++) {\n        domains[i].enter();\n      }\n    }\n\n    return ret;\n  };\n}\n\nfunction wrapCallbackInDomain(ee, fn) {\n  if (typeof fn !== 'function') {\n    return undefined;\n  }\n\n  if (fn.domain) {\n    return fn;\n  }\n\n  var domain = process.domain;\n\n  if (domain) {\n    return domain.bind(fn);\n  } else if (ee) {\n    return unwrapFromDomain(wrapToDomain(ee, fn));\n  } else {\n    return fn;\n  }\n}\n\nfunction wrapToDomain(ee, fn) {\n  return function () {\n    if (Events.usingDomains && ee.domain) {\n      ee.domain.enter();\n      fn.apply(this, arguments);\n      ee.domain.exit();\n    } else {\n      fn.apply(this, arguments);\n    }\n  };\n}","map":{"version":3,"names":["Crypto","require","Events","Net","tls","ConnectionConfig","Protocol","SqlString","Query","Util","module","exports","Connection","inherits","EventEmitter","options","call","config","_socket","socket","_protocol","connection","_connectCalled","state","threadId","createQuery","sql","values","callback","cb","Object","create","undefined","defineProperty","value","wrapCallbackInDomain","TypeError","prototype","connect","socketPath","createConnection","port","host","usingDomains","domain","on","data","write","wrapToDomain","end","_handleNetworkError","bind","_handleProtocolConnect","_handleProtocolHandshake","_handleProtocolInitialize","_handleProtocolError","_handleProtocolDrain","_handleProtocolEnd","_handleProtocolEnqueue","connectTimeout","handleConnectTimeout","_handleConnectTimeout","setTimeout","once","handshake","changeUser","_implyConnect","charsetNumber","charset","getCharsetNumber","user","password","database","timeout","currentConfig","beginTransaction","query","commit","rollback","_connection","typeCast","format","_callback","_enqueue","ping","statistics","stats","opts","quit","destroy","pause","resume","escape","timezone","escapeId","queryFormat","stringifyObjects","TLSSocket","_startTLS","onSecure","createSecureContext","err","secureContext","removeAllListeners","rejectUnauthorized","ssl","secureEstablished","secureSocket","requestCert","isServer","pipe","verifyError","_start","credentials","createCredentials","ca","cert","ciphers","key","passphrase","securePair","createSecurePair","encrypted","cleartext","Error","code","_cycle","cycle","error","apply","arguments","errorno","syscall","handleNetworkError","emit","packet","sequence","context","unwrapFromDomain","fn","domains","ret","process","shift","exit","i","length","enter","ee"],"sources":["C:/Users/ZCJ/Desktop/internshipsysrem/node_modules/mysql/lib/Connection.js"],"sourcesContent":["var Crypto           = require('crypto');\nvar Events           = require('events');\nvar Net              = require('net');\nvar tls              = require('tls');\nvar ConnectionConfig = require('./ConnectionConfig');\nvar Protocol         = require('./protocol/Protocol');\nvar SqlString        = require('./protocol/SqlString');\nvar Query            = require('./protocol/sequences/Query');\nvar Util             = require('util');\n\nmodule.exports = Connection;\nUtil.inherits(Connection, Events.EventEmitter);\nfunction Connection(options) {\n  Events.EventEmitter.call(this);\n\n  this.config = options.config;\n\n  this._socket        = options.socket;\n  this._protocol      = new Protocol({config: this.config, connection: this});\n  this._connectCalled = false;\n  this.state          = 'disconnected';\n  this.threadId       = null;\n}\n\nConnection.createQuery = function createQuery(sql, values, callback) {\n  if (sql instanceof Query) {\n    return sql;\n  }\n\n  var cb      = callback;\n  var options = {};\n\n  if (typeof sql === 'function') {\n    cb = sql;\n  } else if (typeof sql === 'object') {\n    options = Object.create(sql);\n\n    if (typeof values === 'function') {\n      cb = values;\n    } else if (values !== undefined) {\n      Object.defineProperty(options, 'values', { value: values });\n    }\n  } else {\n    options.sql = sql;\n\n    if (typeof values === 'function') {\n      cb = values;\n    } else if (values !== undefined) {\n      options.values = values;\n    }\n  }\n\n  if (cb !== undefined) {\n    cb = wrapCallbackInDomain(null, cb);\n\n    if (cb === undefined) {\n      throw new TypeError('argument callback must be a function when provided');\n    }\n  }\n\n  return new Query(options, cb);\n};\n\nConnection.prototype.connect = function connect(options, callback) {\n  if (!callback && typeof options === 'function') {\n    callback = options;\n    options = {};\n  }\n\n  if (!this._connectCalled) {\n    this._connectCalled = true;\n\n    // Connect either via a UNIX domain socket or a TCP socket.\n    this._socket = (this.config.socketPath)\n      ? Net.createConnection(this.config.socketPath)\n      : Net.createConnection(this.config.port, this.config.host);\n\n    // Connect socket to connection domain\n    if (Events.usingDomains) {\n      this._socket.domain = this.domain;\n    }\n\n    var connection = this;\n    this._protocol.on('data', function(data) {\n      connection._socket.write(data);\n    });\n    this._socket.on('data', wrapToDomain(connection, function (data) {\n      connection._protocol.write(data);\n    }));\n    this._protocol.on('end', function() {\n      connection._socket.end();\n    });\n    this._socket.on('end', wrapToDomain(connection, function () {\n      connection._protocol.end();\n    }));\n\n    this._socket.on('error', this._handleNetworkError.bind(this));\n    this._socket.on('connect', this._handleProtocolConnect.bind(this));\n    this._protocol.on('handshake', this._handleProtocolHandshake.bind(this));\n    this._protocol.on('initialize', this._handleProtocolInitialize.bind(this));\n    this._protocol.on('unhandledError', this._handleProtocolError.bind(this));\n    this._protocol.on('drain', this._handleProtocolDrain.bind(this));\n    this._protocol.on('end', this._handleProtocolEnd.bind(this));\n    this._protocol.on('enqueue', this._handleProtocolEnqueue.bind(this));\n\n    if (this.config.connectTimeout) {\n      var handleConnectTimeout = this._handleConnectTimeout.bind(this);\n\n      this._socket.setTimeout(this.config.connectTimeout, handleConnectTimeout);\n      this._socket.once('connect', function() {\n        this.setTimeout(0, handleConnectTimeout);\n      });\n    }\n  }\n\n  this._protocol.handshake(options, wrapCallbackInDomain(this, callback));\n};\n\nConnection.prototype.changeUser = function changeUser(options, callback) {\n  if (!callback && typeof options === 'function') {\n    callback = options;\n    options = {};\n  }\n\n  this._implyConnect();\n\n  var charsetNumber = (options.charset)\n    ? ConnectionConfig.getCharsetNumber(options.charset)\n    : this.config.charsetNumber;\n\n  return this._protocol.changeUser({\n    user          : options.user || this.config.user,\n    password      : options.password || this.config.password,\n    database      : options.database || this.config.database,\n    timeout       : options.timeout,\n    charsetNumber : charsetNumber,\n    currentConfig : this.config\n  }, wrapCallbackInDomain(this, callback));\n};\n\nConnection.prototype.beginTransaction = function beginTransaction(options, callback) {\n  if (!callback && typeof options === 'function') {\n    callback = options;\n    options = {};\n  }\n\n  options = options || {};\n  options.sql = 'START TRANSACTION';\n  options.values = null;\n\n  return this.query(options, callback);\n};\n\nConnection.prototype.commit = function commit(options, callback) {\n  if (!callback && typeof options === 'function') {\n    callback = options;\n    options = {};\n  }\n\n  options = options || {};\n  options.sql = 'COMMIT';\n  options.values = null;\n\n  return this.query(options, callback);\n};\n\nConnection.prototype.rollback = function rollback(options, callback) {\n  if (!callback && typeof options === 'function') {\n    callback = options;\n    options = {};\n  }\n\n  options = options || {};\n  options.sql = 'ROLLBACK';\n  options.values = null;\n\n  return this.query(options, callback);\n};\n\nConnection.prototype.query = function query(sql, values, cb) {\n  var query = Connection.createQuery(sql, values, cb);\n  query._connection = this;\n\n  if (!(typeof sql === 'object' && 'typeCast' in sql)) {\n    query.typeCast = this.config.typeCast;\n  }\n\n  if (query.sql) {\n    query.sql = this.format(query.sql, query.values);\n  }\n\n  if (query._callback) {\n    query._callback = wrapCallbackInDomain(this, query._callback);\n  }\n\n  this._implyConnect();\n\n  return this._protocol._enqueue(query);\n};\n\nConnection.prototype.ping = function ping(options, callback) {\n  if (!callback && typeof options === 'function') {\n    callback = options;\n    options = {};\n  }\n\n  this._implyConnect();\n  this._protocol.ping(options, wrapCallbackInDomain(this, callback));\n};\n\nConnection.prototype.statistics = function statistics(options, callback) {\n  if (!callback && typeof options === 'function') {\n    callback = options;\n    options = {};\n  }\n\n  this._implyConnect();\n  this._protocol.stats(options, wrapCallbackInDomain(this, callback));\n};\n\nConnection.prototype.end = function end(options, callback) {\n  var cb   = callback;\n  var opts = options;\n\n  if (!callback && typeof options === 'function') {\n    cb   = options;\n    opts = null;\n  }\n\n  // create custom options reference\n  opts = Object.create(opts || null);\n\n  if (opts.timeout === undefined) {\n    // default timeout of 30 seconds\n    opts.timeout = 30000;\n  }\n\n  this._implyConnect();\n  this._protocol.quit(opts, wrapCallbackInDomain(this, cb));\n};\n\nConnection.prototype.destroy = function() {\n  this.state = 'disconnected';\n  this._implyConnect();\n  this._socket.destroy();\n  this._protocol.destroy();\n};\n\nConnection.prototype.pause = function() {\n  this._socket.pause();\n  this._protocol.pause();\n};\n\nConnection.prototype.resume = function() {\n  this._socket.resume();\n  this._protocol.resume();\n};\n\nConnection.prototype.escape = function(value) {\n  return SqlString.escape(value, false, this.config.timezone);\n};\n\nConnection.prototype.escapeId = function escapeId(value) {\n  return SqlString.escapeId(value, false);\n};\n\nConnection.prototype.format = function(sql, values) {\n  if (typeof this.config.queryFormat === 'function') {\n    return this.config.queryFormat.call(this, sql, values, this.config.timezone);\n  }\n  return SqlString.format(sql, values, this.config.stringifyObjects, this.config.timezone);\n};\n\nif (tls.TLSSocket) {\n  // 0.11+ environment\n  Connection.prototype._startTLS = function _startTLS(onSecure) {\n    var connection = this;\n\n    createSecureContext(this.config, function (err, secureContext) {\n      if (err) {\n        onSecure(err);\n        return;\n      }\n\n      // \"unpipe\"\n      connection._socket.removeAllListeners('data');\n      connection._protocol.removeAllListeners('data');\n\n      // socket <-> encrypted\n      var rejectUnauthorized = connection.config.ssl.rejectUnauthorized;\n      var secureEstablished  = false;\n      var secureSocket       = new tls.TLSSocket(connection._socket, {\n        rejectUnauthorized : rejectUnauthorized,\n        requestCert        : true,\n        secureContext      : secureContext,\n        isServer           : false\n      });\n\n      // error handler for secure socket\n      secureSocket.on('_tlsError', function(err) {\n        if (secureEstablished) {\n          connection._handleNetworkError(err);\n        } else {\n          onSecure(err);\n        }\n      });\n\n      // cleartext <-> protocol\n      secureSocket.pipe(connection._protocol);\n      connection._protocol.on('data', function(data) {\n        secureSocket.write(data);\n      });\n\n      secureSocket.on('secure', function() {\n        secureEstablished = true;\n\n        onSecure(rejectUnauthorized ? this.ssl.verifyError() : null);\n      });\n\n      // start TLS communications\n      secureSocket._start();\n    });\n  };\n} else {\n  // pre-0.11 environment\n  Connection.prototype._startTLS = function _startTLS(onSecure) {\n    // before TLS:\n    //  _socket <-> _protocol\n    // after:\n    //  _socket <-> securePair.encrypted <-> securePair.cleartext <-> _protocol\n\n    var connection  = this;\n    var credentials = Crypto.createCredentials({\n      ca         : this.config.ssl.ca,\n      cert       : this.config.ssl.cert,\n      ciphers    : this.config.ssl.ciphers,\n      key        : this.config.ssl.key,\n      passphrase : this.config.ssl.passphrase\n    });\n\n    var rejectUnauthorized = this.config.ssl.rejectUnauthorized;\n    var secureEstablished  = false;\n    var securePair         = tls.createSecurePair(credentials, false, true, rejectUnauthorized);\n\n    // error handler for secure pair\n    securePair.on('error', function(err) {\n      if (secureEstablished) {\n        connection._handleNetworkError(err);\n      } else {\n        onSecure(err);\n      }\n    });\n\n    // \"unpipe\"\n    this._socket.removeAllListeners('data');\n    this._protocol.removeAllListeners('data');\n\n    // socket <-> encrypted\n    securePair.encrypted.pipe(this._socket);\n    this._socket.on('data', function(data) {\n      securePair.encrypted.write(data);\n    });\n\n    // cleartext <-> protocol\n    securePair.cleartext.pipe(this._protocol);\n    this._protocol.on('data', function(data) {\n      securePair.cleartext.write(data);\n    });\n\n    // secure established\n    securePair.on('secure', function() {\n      secureEstablished = true;\n\n      if (!rejectUnauthorized) {\n        onSecure();\n        return;\n      }\n\n      var verifyError = this.ssl.verifyError();\n      var err = verifyError;\n\n      // node.js 0.6 support\n      if (typeof err === 'string') {\n        err = new Error(verifyError);\n        err.code = verifyError;\n      }\n\n      onSecure(err);\n    });\n\n    // node.js 0.8 bug\n    securePair._cycle = securePair.cycle;\n    securePair.cycle  = function cycle() {\n      if (this.ssl && this.ssl.error) {\n        this.error();\n      }\n\n      return this._cycle.apply(this, arguments);\n    };\n  };\n}\n\nConnection.prototype._handleConnectTimeout = function() {\n  if (this._socket) {\n    this._socket.setTimeout(0);\n    this._socket.destroy();\n  }\n\n  var err = new Error('connect ETIMEDOUT');\n  err.errorno = 'ETIMEDOUT';\n  err.code = 'ETIMEDOUT';\n  err.syscall = 'connect';\n\n  this._handleNetworkError(err);\n};\n\nConnection.prototype._handleNetworkError = function(err) {\n  this._protocol.handleNetworkError(err);\n};\n\nConnection.prototype._handleProtocolError = function(err) {\n  this.state = 'protocol_error';\n  this.emit('error', err);\n};\n\nConnection.prototype._handleProtocolDrain = function() {\n  this.emit('drain');\n};\n\nConnection.prototype._handleProtocolConnect = function() {\n  this.state = 'connected';\n  this.emit('connect');\n};\n\nConnection.prototype._handleProtocolHandshake = function _handleProtocolHandshake() {\n  this.state = 'authenticated';\n};\n\nConnection.prototype._handleProtocolInitialize = function _handleProtocolInitialize(packet) {\n  this.threadId = packet.threadId;\n};\n\nConnection.prototype._handleProtocolEnd = function(err) {\n  this.state = 'disconnected';\n  this.emit('end', err);\n};\n\nConnection.prototype._handleProtocolEnqueue = function _handleProtocolEnqueue(sequence) {\n  this.emit('enqueue', sequence);\n};\n\nConnection.prototype._implyConnect = function() {\n  if (!this._connectCalled) {\n    this.connect();\n  }\n};\n\nfunction createSecureContext (config, cb) {\n  var context = null;\n  var error   = null;\n\n  try {\n    context = tls.createSecureContext({\n      ca         : config.ssl.ca,\n      cert       : config.ssl.cert,\n      ciphers    : config.ssl.ciphers,\n      key        : config.ssl.key,\n      passphrase : config.ssl.passphrase\n    });\n  } catch (err) {\n    error = err;\n  }\n\n  cb(error, context);\n}\n\nfunction unwrapFromDomain(fn) {\n  return function () {\n    var domains = [];\n    var ret;\n\n    while (process.domain) {\n      domains.shift(process.domain);\n      process.domain.exit();\n    }\n\n    try {\n      ret = fn.apply(this, arguments);\n    } finally {\n      for (var i = 0; i < domains.length; i++) {\n        domains[i].enter();\n      }\n    }\n\n    return ret;\n  };\n}\n\nfunction wrapCallbackInDomain(ee, fn) {\n  if (typeof fn !== 'function') {\n    return undefined;\n  }\n\n  if (fn.domain) {\n    return fn;\n  }\n\n  var domain = process.domain;\n\n  if (domain) {\n    return domain.bind(fn);\n  } else if (ee) {\n    return unwrapFromDomain(wrapToDomain(ee, fn));\n  } else {\n    return fn;\n  }\n}\n\nfunction wrapToDomain(ee, fn) {\n  return function () {\n    if (Events.usingDomains && ee.domain) {\n      ee.domain.enter();\n      fn.apply(this, arguments);\n      ee.domain.exit();\n    } else {\n      fn.apply(this, arguments);\n    }\n  };\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}